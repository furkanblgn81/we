{% extends "base.html" %}
{% block content %}
<h2 class="text-center mb-4">YÃ¼klenen Dosyalar</h2>

<div class="table-responsive">
    <table class="table table-bordered table-striped align-middle text-center">
        <thead class="table-dark">
            <tr>
                <th>Dosya AdÄ±</th>
                <th>GÃ¶nderilen Email</th>
                <th>YÃ¼kleyen</th>
                <th>YÃ¼klenme Tarihi</th>
                <th>GeÃ§erlilik Tarihi</th>
                <th>Ä°ndirme LoglarÄ±</th>
            </tr>
        </thead>
        <tbody>
            {% for file in files %}
            <tr>
                <td>{{ file.original_filename }}</td>
                <td>{{ file.receiver_email }}</td>
                <td>{{ file.registered_user or file.guest_email }}</td>
                <td>{{ file.upload_date.strftime('%Y-%m-%d %H:%M') if file.upload_date else '' }}</td>
                <td>{{ file.max_download_time.strftime('%Y-%m-%d %H:%M') if file.max_download_time else '' }}</td>
                <td style="max-width: 300px; overflow-y: auto;">
                    {% set logs = get_download_logs(file.id) %}
                    {% if logs %}
                        <ul class="list-unstyled text-start">
                            {% for log in logs %}
                                <li>ðŸ“¥ {{ log.downloader_email }} â€“ {{ log.download_time.strftime('%Y-%m-%d %H:%M') }}</li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <small class="text-muted">Ä°ndirme kaydÄ± yok</small>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
